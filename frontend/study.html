<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>AI Agent - Introduction to Python</title>
        <link rel="stylesheet" href="style.css">
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500&family=Noto+Serif+JP:wght@400;600&display=swap" rel="stylesheet"> <!--importing the fonts-->
    </head>
    <body>
        <nav>
            <a href="homepage.html">Home</a> |
            <a href="study.html">Study!</a> |
            <a href="credits.html">Credits</a>
        </nav>
        <div class="layout">
            <div id="chat_history">
                <h1>Chat History:</h1>
            </div>
            <div class="center">
            <h1>AI Agent For Python (beginners)</h1>
            <p>Ask the AI any questions pertaining to Python (beginner level like syntax or basic concepts)
                <br> Example Question: What is a string?
                <br> Example Question: What are the naming rules for Python variables?
                <br> Example Question: What is the difference between a for loop and a while loop?</p>
            <label for="userInput">Enter Here:</label>
            <textarea id="userInput" placeholder="Type your question here..."></textarea>
            <button id="ask-button" type="button">Ask a Question</button>
            <div id="answer-box"></div>
            </div>    
        </div>
        <footer class="footer">
            <p>© 2025 Benjamin Chong</p>
            <p>Python Study Assistant · Educational Project</p>
        </footer>
        <script> /* scrollable for user input */
            const ta = document.getElementById("userInput");

            ta.addEventListener("input", () => {
                ta.style.height = "auto";    // reset height
                ta.style.height = ta.scrollHeight + "px"; // expand to fit content
            });
        </script>
        <script> /* function to append messages */
        function addMessage(role, text) {
            const chat = document.getElementById("chat_history");
            const div = document.createElement("div");
            div.className = role == "user" ? "message_user" : "message_assistant";
            div.textContent = text;
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
            return div
        }
        </script>

        <script> /* AI agent response */
        const button = document.getElementById("ask-button");
        const input = document.getElementById("userInput");
        const answerBox = document.getElementById("answer-box");
        
        button.addEventListener("click", async () => {
            const question = input.value.trim();
            if (!question) {
                answerBox.textContent = "Invalid Question"
                return;
            }
            addMessage("user", "You: "+ question);
            input.value = "";
            input.style.height = "auto";

            const thinkingMessage = addMessage("assistant", "Assistant: Thinking...")
            
            answerBox.textContent = "Thinking...";

            try {
            const response = await fetch("http://localhost:8000/ask", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({ question }),
            });
            const data = await response.json();
            thinkingMessage.textContent = "Assistant: " + data.answer;
            answerBox.textContent = data.answer;
            } catch (err) {
            thinkingMessage.textContent = "Assistant: Error contacting server."
            answerBox.textContent = "Error contacting server.";
            }
        });
        </script>
    </body>
</html>